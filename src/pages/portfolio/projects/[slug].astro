---
import PortfolioLayout from "@/layouts/PortfolioLayout.astro";
import Container from "@/components/ui/Container.astro";
import Hero from "@/components/portfolio/projects/Hero.astro";
import MVP from "@/components/portfolio/projects/MVP.astro";
import Brief from "@/components/portfolio/projects/Brief.astro";
import Results from "@/components/portfolio/projects/Results.astro";
import Grid from "@/components/portfolio/projects/Grid.astro";
import CtaContact from "@/components/portfolio/home/CtaContact.astro";
import { getCollection, getEntry } from "astro:content";

export async function getStaticPaths() {
	const entries = await getCollection("projects");
	return entries.map((entry) => ({
		params: { slug: entry.slug },
	}));
}

const { slug } = Astro.params;
const entry = await getEntry("projects", slug);

if (!entry) {
	throw new Error("Proyecto no encontrado");
}

const { Content } = await entry.render();
const data = entry.data!;
const cover = data.summary?.cover;
const note = data.summary?.note;
---

<PortfolioLayout title={`${data.title}`}>
	<Container
		class="flex-col-center-6 mx-auto mb-12 px-6 md:px[32px] pt-[80px] max-w-[80rem]"
	>
		<Hero {data} />
		<Container class="grid2-center-6 max-w-[60rem]" id="more">
			<MVP {data} {cover} {note} />
			<Brief
				objective={data.objective}
				build={data.build}
				results={data.results}
				links={data.links}
			/>
		</Container>
		<Results learnings={data.learnings} />
		{data.images && <Grid data={data} />}
	</Container>
	<CtaContact />
</PortfolioLayout>
